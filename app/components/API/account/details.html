<div class="container-fluid"><div class="row"><div class="col-sm-12">
<hr />

    <div class="row">
        <div class="col-sm-8 col-sm-offset-2">
            <h1 class="text-center no-vertical-margin">{{ account.owner.full_name }}</h1>
        </div>
    </div>

    <br />

    <div class="row">
        <div class="col-sm-12">
            <form class="form-inline" role="form" ng-submit="query(query_qty, query_type, query_motive)" ng-if="user.can('add_transaction')">
                <select class="form-control" ng-model="query_type">
                    <option value="give" ng-if="user.can('add_givetransaction')">Faire un don</option>
                    <option value="punish" ng-if="user.can('add_punishtransaction')">Mettre une amende</option>
                    <option value="deposit" ng-if="user.can('add_deposittransaction')">Créditer le compte</option>
                </select>
                <input type="number" class="form-control number" ng-model="query_qty" select-on-click />
                <span ng-show="query_type == 'punish'">
                    <input type="text" class="form-control large" ng-model="query_motive" placeholder="Motif de l'amende" />
                    <input type="submit" class="btn btn-warning" value="Mettre une amende{{ query_qty > 0 && ' de ' + (query_qty | currency) || '' }}" ng-class="(query_qty <= 0) && 'disabled' || ''" />
                </span>
                <input ng-show="query_type != 'punish'" type="submit" class="btn btn-success" value="{{ query_type == 'give' && 'Donner' || 'Créditer' }} {{ query_qty > 0 && ' ' + (query_qty | currency) || '' }}" ng-class="query_qty <= 0 && 'disabled' || ''" />
            </form>
        </div>
    </div>

    <br />

    <div class="row">
        <div class="col-sm-12">
            <tabset>
                <tab heading="Infos">
                    <div class="row">
                        <table class="table table-tab">
                            <tbody>
                                <tr>
                                    <td class="h4">Solde</td>
                                    <td class="end-of-column text-right">
                                        <span class="h4"><span class="label" ng-class="account.money > 0 && 'label-success' || 'label-danger'">
                                            {{ account.money | currency }}
                                        </span></span>
                                    </td>
                                    <td class="h4">Rang</td>
                                    <td class="text-right">
                                        <span class="h4"><span class="badge">
                                            4
                                        </span></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="h4">Total dépensé</td>
                                    <td class="end-of-column text-right">
                                        <span class="h4"><span class="label label-default">
                                            {{ 1000 | currency}}
                                        </span></span>
                                    </td>
                                    <td class="h4">Amendes</td>
                                    <td class="text-right">
                                        <span class="h4"><span class="label label-danger">
                                            {{ 13 | currency }}
                                        </span></span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </tab>
                <tab heading="Graphiques">
                    <div class="row">
                        <div class="col-sm-12 text-center">
                            <div class="list-group">
                                <div class="list-group-item">
                                    <h1>ICI un BÔÔÔ GRAPHIQUE</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </tab>
                <tab heading="Modifier" ng-if="user.can('change_account')">
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <fieldset>
                                <h3>Modifier le login</h3>
                                <div class="alert alert-success alert-dismissible" role="alert" ng-if="usernameSuccess == 1">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Fermer"><span aria-hidden="true">&times;</span></button>
                                    Le login a été changé avec succès.
                                </div>
                                <div class="alert alert-danger alert-dismissible" role="alert" ng-if="usernameSuccess == -1">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Fermer"><span aria-hidden="true">&times;</span></button>
                                    Une erreur est survenue : le login n'a pas été modifié...
                                </div>
                                <div>
                                    <form class="form-horizontal" ng-submit="changeUsername()">
                                        <div class="form-group">
                                            <label for="ousername" class="col-sm-3 control-label">Login actuel</label>
                                            <div class="col-sm-9">
                                                <p class="form-control-static">{{ account.owner.username }}</p>
                                            </div>
                                        </div>
                                        <div class="form-group" ng-class="!checkUsername() && 'has-error' || ''">
                                            <label for="nusername" class="col-sm-3 control-label">Nouveau login</label>
                                            <div class="col-sm-9">
                                              <input type="text" class="form-control" id="nusername" ng-model="account.owner.nusername">
                                              <span class="help-block" ng-if="!checkUsername()">Ce login existe déjà.</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-offset-3 col-sm-9">
                                                <input type="submit" class="btn btn-success" ng-class="!checkUsername() && 'disabled' || ''" value="Valider" />
                                            </div>
                                          </div>
                                    </form>
                                </div>
                            </fieldset>
                            <fieldset>
                                <h3>Modifier le mot de passe</h3>
                                <div class="alert alert-success alert-dismissible" role="alert" ng-if="pwdSuccess == 1">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Fermer"><span aria-hidden="true">&times;</span></button>
                                    Le mot de passe a bien été modifié.
                                </div>
                                <div class="alert alert-danger alert-dismissible" role="alert" ng-if="pwdSuccess == -1">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Fermer"><span aria-hidden="true">&times;</span></button>
                                    Une erreur est survenue : le mot de passe n'a pas été modifié...
                                </div>
                                <div>
                                    <form class="form-horizontal" ng-submit="changePwd()">
                                        <div class="form-group" ng-class="(newPwd != newPwdBis) && 'has-error' || ''">
                                            <label for="newPwd" class="col-sm-3 control-label">Nouveau mot de passe</label>
                                            <div class="col-sm-9">
                                              <input type="password" class="form-control" id="newPwd" ng-model="newPwd">
                                            </div>
                                        </div>
                                        <div class="form-group" ng-class="(newPwd != newPwdBis) && 'has-error' || ''">
                                            <label for="newPwdBis" class="col-sm-3 control-label">Confirmation</label>
                                            <div class="col-sm-9">
                                              <input type="password" class="form-control" id="newPwdBis" ng-model="newPwdBis">
                                              <span class="help-block" ng-if="(newPwd != newPwdBis)">Les mots de passe sont différents.</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <div class="col-sm-offset-3 col-sm-9">
                                                <input type="submit" class="btn btn-success" ng-class="(newPwd != newPwdBis) && 'disabled' || ''" value="Valider" />
                                            </div>
                                          </div>
                                    </form>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                </tab>
            </tabset>
        </div>
    </div>
</div></div></div>

<bars:history filter="{account: account.id}"></bars:history>

<form class="form-horizontal" ng-submit="addFood()">
    <div class="form-group" ng-class="barcodeErrorSI && ' has-error' || ''">
        <label for="fbarcode" class="col-sm-2 control-label">Code-barre</label>
        <div class="col-sm-10">
            <div class="input-group">
                <div class="input-group-addon">
                    <span class="glyphicon glyphicon-barcode"></span>
                </div>
                <input type="text" class="form-control" id="fbarcode" placeholder="3017624047813" ng-disabled="!allow_barcode_edit" ng-model="barcode" ng-keypress="searchf($event)" ng-change="searchGlobal(barcode, true)">
            </div>
            <span class="help-block" ng-if="barcodeErrorSI">
                Cet aliment existe déjà dans le bar : <bars:stockitem item="barcodeErrorSI"></bars:stockitem>
            </span>
        </div>
    </div>
    <div class="text-center">
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2">
                <p><small>Si votre aliment est un paquet, et si les éléments du paquet ont leur propre code-barre (typiquement un pack de canettes de coca) choisissez <strong>pack</strong>.</small></p>
            </div>
        </div>
        <hr class="derrierebtn" />
        <div class="btn-group btn-group-sm derrierebtn">
            <a class="btn btn-primary" ng-class="!is_pack && 'active'" ng-click="is_pack = false">Il s'agit d'un aliment normal</a>
            <a class="btn btn-primary" ng-class="is_pack && 'active'" ng-click="is_pack = true">Il s'agit d'un pack</a>
        </div>
        <br /><br />
    </div>
    <div ng-show="is_pack">
        <div class="form-group">
            <label for="fpqty" class="col-sm-2 control-label">Un pack contient</label>
            <div class="col-sm-3">
                <input type="number" class="form-control" id="fpqty" placeholder="6" ng-model="buy_item.itemqty" tooltip="Nombre de produits dans un pack" tooltip-trigger="focus" tooltip-placement="bottom" ng-disabled="buy_item.id">
            </div>
            <div class="col-sm-7">
                <div class="input-group">
                    <div class="input-group-addon">
                        <span class="glyphicon glyphicon-barcode"></span>
                    </div>
                    <input type="text" class="form-control" placeholder="canettes de coca 33cl" ng-model="itemInPack" tooltip="Produit contenu dans le pack" tooltip-trigger="focus" tooltip-placement="bottom" typeahead="item.buyitem.details.name for item in buy_item_pricesf($viewValue) | limitTo:5" autocomplete="off" typeahead-on-select="choiceItemDetail($item, $model, $label)" ng-keypress="createItemPack($event)" ng-disabled="block">
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="fpprice" class="col-sm-2 control-label">Prix</label>
            <div class="col-sm-7">
                <input type="text" class="form-control" id="fpprice" placeholder="2.34" ng-model="buy_item_price.price" ng-disabled="buy_item_price.id">
            </div>
            <label class="col-sm-3 control-label">€ / pack</label>
        </div>
    </div>
    <div ng-show="!is_pack">
        <div class="form-group">
            <label for="fname" class="col-sm-2 control-label">Nom d'achat</label>
            <div class="col-sm-4">
              <input type="text" class="form-control" id="fname" placeholder="Pot de 830g de Nutella" ng-disabled="item_details.id" ng-model="item_details.name" tooltip="Nomination exacte du produit acheté" tooltip-trigger="focus" tooltip-placement="bottom">
            </div>
            <label for="fname_plural" class="col-sm-2 control-label">Pluriel</label>
            <div class="col-sm-4">
              <input type="text" class="form-control" id="fname_plural" placeholder="Pots de 830g de Nutella" ng-disabled="item_details.id" ng-model="item_details.name_plural" tooltip-trigger="focus" tooltip-placement="bottom">
            </div>
        </div>
        <div class="text-center">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2">
                    <p>
                        <small>Vous pouvez choisir de vendre sous un même nom des aliments aux codes-barres différents.<br />
                        Par exemple, vous achetez des pots de Nutella de 720g, 800g et 1kg et vous souhaitez simplement vendre du "Nutella".</small>
                    </p>
                </div>
            </div>
            <hr class="derrierebtn" />
            <div class="btn-group btn-group-sm derrierebtn">
                <a class="btn btn-primary" ng-class="new_sell && 'active'" ng-click="new_sell = true">Le bar ne vend pas encore cet aliment</a>
                <a class="btn btn-primary" ng-class="!new_sell && 'active'" ng-click="new_sell = false">Rattacher à un aliment déjà vendu</a>
            </div>
            <br /><br />
        </div>
        <div ng-show="new_sell">
            <div class="form-group">
                <label for="fsname" class="col-sm-2 control-label">Nom de vente</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" id="fsname" placeholder="Nutella" ng-model="sell_item.name" tooltip="Au singulier si cet aliment n'a pas d'unité" tooltip-trigger="focus" tooltip-placement="bottom" ng-disabled="sell_item.id">
                </div>
                <label for="fsname_plural" class="col-sm-2 control-label">Pluriel</label>
                <div class="col-sm-4">
                  <input type="text" class="form-control" id="fsname_plural" placeholder="Nutella" ng-model="sell_item.name_plural" tooltip-trigger="focus" tooltip-placement="bottom" ng-disabled="sell_item.id">
                </div>
            </div>
            <div class="form-group">
                <label for="funit" class="col-sm-2 control-label">Unité de vente</label>
                <div class="col-sm-4">
                    <input type="text" class="form-control" id="funit" placeholder="g" ng-model="sell_item.unit_name" tooltip="L'unité utilisée par les utilisateurs. Laisser vide si l'aliment se vend à l'unité (par exemple les pizzas)." tooltip-trigger="focus" tooltip-placement="bottom" ng-disabled="sell_item.id">
                </div>
                <label for="funit_plural" class="col-sm-2 control-label">Pluriel</label>
                <div class="col-sm-4">
                    <input type="text" class="form-control" id="funit_plural" placeholder="g" ng-model="sell_item.unit_name_plural" tooltip="" tooltip-trigger="focus" tooltip-placement="bottom" ng-disabled="sell_item.id">
                </div>
            </div>
        </div>
        <div ng-show="!new_sell">
            <div class="form-group">
                <label for="funit" class="col-sm-2 control-label">Aliment</label>
                <div class="col-sm-10">
                  <input type="text" class="form-control" placeholder="Nutella" ng-model="oldSellItem" tooltip="Produit déjà vendu par le bar" tooltip-trigger="focus" tooltip-placement="bottom" typeahead="item.name for item in sellitemsf($viewValue) | limitTo:5" autocomplete="off" typeahead-on-select="choiceSellItem($item, $model, $label)" typeahead-template-url="components/admin/food/typehead-sell-item.html"  ng-disabled="block" />
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="fsell_to_buy" class="col-sm-2 control-label">1 {{ item_details.name }} = </label>
            <div class="col-sm-10">
                <div class="input-group">
                    <input type="text" class="form-control" id="fsell_to_buy" placeholder="1000" ng-model="stock_item.sell_to_buy" ng-disabled="stock_item.id">
                    <div class="input-group-addon">
                        {{ (sell_item.unit_name_plural && stock_item.sell_to_buy > 1) && sell_item.unit_name_plural || (sell_item.unit_name || ((sell_item.name_plural && stock_item.sell_to_buy > 1) && sell_item.name_plural || sell_item.name)) }}
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="fprice" class="col-sm-2 control-label">Prix</label>
            <div class="col-sm-10">
                <div class="input-group">
                    <input type="text" class="form-control" id="fprice" placeholder="2.34" ng-model="buy_item_price.price" ng-disabled="buy_item_price.id">
                    <div class="input-group-addon">
                        € / {{ item_details.name }}
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group" ng-if="new_sell">
            <label for="tax" class="col-sm-2 control-label">Taxe</label>
            <div class="col-sm-10">
                <div class="input-group">
                    <input type="text" class="form-control" id="tax" placeholder="20" ng-model="sell_item.tax" ng-disabled="sell_item.id">
                    <span class="input-group-addon">%</span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="fkeywords" class="col-sm-2 control-label">Mots clés</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="fkeywords" placeholder="séparés par des espaces" ng-disabled="item_details.id" ng-model="item_details.keywords">
            </div>
        </div>
        <div class="form-group" ng-if="buy_item_price.price && sell_item.name && sell_item.tax && stock_item.sell_to_buy">
            <label class="col-sm-2 control-label">Aperçu</label>
            <div class="col-sm-10">
                <p class="form-control-static">
                    Achat de <bars:sellitem item="sell_item" qty="53"></bars:sellitem> pour {{ buy_item_price.price*(1+sell_item.tax/100)/stock_item.sell_to_buy*53 | currency }}
                </p>
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
            <input type="submit" class="btn btn-primary" value="Ajouter" ng-class="!isValid() && 'disabled' || ''" />
        </div>
    </div>
</form>

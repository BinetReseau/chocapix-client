<div class="col-sm-12 col-md-12 col-lg-12">
    <fieldset>
        <legend><a title="Faire une appro" class="link" ng-click="formAppro = !formAppro">Faire une appro</a></legend>
        <div rmthis-ng-if="formAppro" class="animated fadeIn">
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="addApproItemInput">Ajouter</label>
                    <div class="col-sm-10">
                        <input type="text" id="addApproItemInput" class="form-control" placeholder="Aliment à ajouter à l'appro" typeahead="item.name for item in bar.foods | filter:$viewValue | limitTo:5" ng-model="appro.itemToAdd" autocomplete="off" typeahead-on-select="appro.addItem($item)" />
                    </div>
                </div>
            </form>
            <div class="panel panel-default">
                <div class="panel-heading clearfix">
                    <h4 class="panel-title pull-left text-capitalizefirst" style="padding-top: 7.5px;">Aliments</h4>
                    <input type="text" class="form-control right small" ng-model="searchl" placeholder="Rechercher parmi l'appro">
                </div>
                <table class="table table-striped table-hover" ng-show="(appro.itemsList | filter:searchl).length > 0">
                    <tr>
                        <th>Nom</th>
                        <th>Quantité</th>
                        <th>Valeur</th>
                    </tr>
                    <tr ng-repeat="item in appro.itemsList | filter:searchl" ng-class="item.item.deleted && 'del'">
                        <td><bars:food food="item.item"></bars:food></td>
                        <td>
                            <input type="number" ng-model="item.qty" class="form-control input-sm pqty" />
                            <select ng-model="item.unit_value">
                                <option value="{{ item.item.buy_unit_value }}">{{ item.item.buy_unit || item.item.name }}</option>
                                <option value="{{ item.item.unit_value }}" ng-if="item.item.buy_unit != item.item.unit">{{ item.item.unit || item.item.name }}</option>
                            </select>
                        </td>
                        <td><span class="label label-info">{{ item.qty*item.unit_value*item.item.price | currency }}</span></td>
                    </tr>
                </table>
                <div class="panel-body" ng-show="(appro.itemsList | filter:filterDeleted() | filter:searchl).length == 0 && searchl">
                    <em>Aucun aliment correspondant à cette recherche ne fait partie de l'appro.</em>
                </div>
            </div>
        </div>
    </fieldset>
    <br />
    <fieldset>
        <legend><a title="Ajouter un nouvel aliment" class="link" ng-click="formAdd = !formAdd">Ajouter un aliment</a></legend>
        <div ng-show="formAdd" class="animated fadeIn">
            <form class="form-horizontal" ng-submit="addFood()">
                <div class="form-group">
                    <label for="fname" class="col-sm-3 control-label">Nom</label>
                    <div class="col-sm-9">
                      <input type="text" class="form-control" id="fname" placeholder="Pates" ng-model="food.name" tooltip="Au singulier si cet aliment n'a pas d'unité" tooltip-trigger="focus" tooltip-placement="bottom">
                    </div>
                </div>
                <div class="form-group">
                    <label for="fbuy_unit" class="col-sm-3 control-label">Unité d'achat</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="fbuy_unit" placeholder="kg" ng-model="food.buy_unit" tooltip="L'unité des appros" tooltip-trigger="focus" tooltip-placement="bottom">
                    </div>
                </div>
                <div class="form-group">
                    <label for="funit" class="col-sm-3 control-label">Unité de vente</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="funit" placeholder="g" ng-model="food.unit" tooltip="L'unité utilisée par les utilisateurs" tooltip-trigger="focus" tooltip-placement="bottom">
                    </div>
                </div>
                <div class="form-group">
                    <label for="fprice" class="col-sm-3 control-label">Prix</label>
                    <div class="col-sm-6">
                      <input type="text" class="form-control" id="fprice" placeholder="2.34" ng-model="food.price">
                    </div>
                    <label class="col-sm-3 control-label">€ / {{ food.buy_unit }}</label>
                </div>
                <div class="form-group">
                    <label for="funit_value" class="col-sm-3 control-label">1 {{ food.buy_unit || food.name }} = </label>
                    <div class="col-sm-6">
                        <input type="text" class="form-control" id="funit_value" placeholder="1000" ng-model="food.unit_value">
                    </div>
                    <label class="col-sm-3 control-label">{{ food.unit || food.name }}</label>
                </div>
                <div class="form-group">
                    <label for="fkeywords" class="col-sm-3 control-label">Mots clés</label>
                    <div class="col-sm-9">
                      <input type="text" class="form-control" id="fkeywords" placeholder="séparés par des espaces" ng-model="food.keywords">
                    </div>
                </div>
                <div class="form-group">
                    <label for="fqty" class="col-sm-3 control-label">Quantité</label>
                    <div class="col-sm-6">
                      <input type="text" class="form-control" id="fqty" placeholder="Quantité initiale" value="0" ng-model="food.qty">
                    </div>
                    <label class="col-sm-3 control-label">{{ food.unit || food.name }}</label>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-3 col-sm-9">
                        <input type="submit" class="btn btn-primary" value="Ajouter" ng-if="!food.qty" />
                        <input type="submit" class="btn btn-success" value="Ajouter et approvisionner pour {{ food.qty/food.unit_value*food.price|currency }}" ng-if="food.qty" />
                    </div>
                  </div>
            </form>
        </div>
    </fieldset>
</div>
<div class="col-sm-12 col-md-12 col-lg-12">
    <div class="graphiquet">
        Graphique
    </div>
    <div class="graphiquet">
        Tableau aliments plus consommés cette semaine
    </div>
    <div class="graphiquet">
        Tableau vols
    </div>
</div>
